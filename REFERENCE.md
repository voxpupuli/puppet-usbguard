# Reference

<!-- DO NOT EDIT: This document was generated by Puppet Strings -->

## Table of Contents

### Classes

* [`usbguard`](#usbguard): Install and configure usbguard
* [`usbguard::config`](#usbguard--config): usbguard::config
* [`usbguard::install`](#usbguard--install): Install the usbguard package
* [`usbguard::service`](#usbguard--service): Manage the usbguard service

### Defined types

* [`usbguard::rule`](#usbguard--rule): Add a usbguard rule

## Classes

### <a name="usbguard"></a>`usbguard`

Install and configure usbguard

#### Examples

##### 

```puppet
include usbguard
```

##### pass rules class param

```puppet
class { 'usbguard':
  rules => [
    'allow with-interface equals { 08:*:* }',
    'reject with-interface all-of { 08:*:* 03:00:* }',
  ],
}
```

#### Parameters

The following parameters are available in the `usbguard` class:

* [`manage_package`](#-usbguard--manage_package)
* [`manage_service`](#-usbguard--manage_service)
* [`manage_rules_file`](#-usbguard--manage_rules_file)
* [`package_ensure`](#-usbguard--package_ensure)
* [`package_name`](#-usbguard--package_name)
* [`service_name`](#-usbguard--service_name)
* [`service_ensure`](#-usbguard--service_ensure)
* [`daemon_audit_backend`](#-usbguard--daemon_audit_backend)
* [`daemon_audit_file_path`](#-usbguard--daemon_audit_file_path)
* [`daemon_authorized_default`](#-usbguard--daemon_authorized_default)
* [`daemon_device_rules_with_port`](#-usbguard--daemon_device_rules_with_port)
* [`daemon_implicit_policy_target`](#-usbguard--daemon_implicit_policy_target)
* [`daemon_ipc_allowed_groups`](#-usbguard--daemon_ipc_allowed_groups)
* [`daemon_ipc_allowed_users`](#-usbguard--daemon_ipc_allowed_users)
* [`daemon_present_controller_policy`](#-usbguard--daemon_present_controller_policy)
* [`daemon_present_device_policy`](#-usbguard--daemon_present_device_policy)
* [`daemon_restore_controller_device_state`](#-usbguard--daemon_restore_controller_device_state)
* [`daemon_rule_file`](#-usbguard--daemon_rule_file)
* [`rules`](#-usbguard--rules)

##### <a name="-usbguard--manage_package"></a>`manage_package`

Data type: `Boolean`

Should the module manage the package or not

Default value: `true`

##### <a name="-usbguard--manage_service"></a>`manage_service`

Data type: `Boolean`

Should the module manage the service or not

Default value: `true`

##### <a name="-usbguard--manage_rules_file"></a>`manage_rules_file`

Data type: `Boolean`

Should the module manage the rules file or not.
If set to false usbguard::rule will not manage the rules and also
rules passed by the rules param of this class will be ignored.

Default value: `true`

##### <a name="-usbguard--package_ensure"></a>`package_ensure`

Data type: `String[1]`

The ensure value of the package resource.

Default value: `installed`

##### <a name="-usbguard--package_name"></a>`package_name`

Data type: `String[1]`

Name of the package containing usbguard

Default value: `'usbguard'`

##### <a name="-usbguard--service_name"></a>`service_name`

Data type: `String[1]`

Name of the service.

Default value: `'usbguard'`

##### <a name="-usbguard--service_ensure"></a>`service_ensure`

Data type: `Enum['running', 'stopped']`

Should the service be running or stopped. Stopped will
also disable the service.

Default value: `'running'`

##### <a name="-usbguard--daemon_audit_backend"></a>`daemon_audit_backend`

Data type: `Enum['FileAudit', 'LinuxAudit']`

AuditBackend setting of usbguard-daemon.conf

Default value: `'FileAudit'`

##### <a name="-usbguard--daemon_audit_file_path"></a>`daemon_audit_file_path`

Data type: `Stdlib::Absolutepath`

Path to the usbguard audit log file.
AuditFilePath setting of usbguard-daemon.conf

Default value: `'/var/log/usbguard/usbguard-audit.log'`

##### <a name="-usbguard--daemon_authorized_default"></a>`daemon_authorized_default`

Data type: `Enum['keep', 'all', 'none', 'internal']`

AuthorizedDefault setting of
usbguard-daemon.conf

Default value: `none`

##### <a name="-usbguard--daemon_device_rules_with_port"></a>`daemon_device_rules_with_port`

Data type: `Boolean`

DeviceRulesWithPort setting of
usbguard-daemon.conf

Default value: `false`

##### <a name="-usbguard--daemon_implicit_policy_target"></a>`daemon_implicit_policy_target`

Data type: `Enum['allow', 'block', 'reject']`

ImplicitPolicyTarget setting of
usbguard-daemon.conf

Default value: `'block'`

##### <a name="-usbguard--daemon_ipc_allowed_groups"></a>`daemon_ipc_allowed_groups`

Data type: `Array[String[1]]`

IPCAllowedGroups setting of
usbguard-daemon.conf

Default value: `['wheel']`

##### <a name="-usbguard--daemon_ipc_allowed_users"></a>`daemon_ipc_allowed_users`

Data type: `Array[String[1]]`

IPCAllowedUsers setting of
usbguard-daemon.conf

Default value: `['root']`

##### <a name="-usbguard--daemon_present_controller_policy"></a>`daemon_present_controller_policy`

Data type: `Enum['allow','block','reject','keep','apply-policy']`

PresentControllerPolicy
setting of usbguard-daemon.conf

Default value: `'keep'`

##### <a name="-usbguard--daemon_present_device_policy"></a>`daemon_present_device_policy`

Data type: `Enum['allow','block','reject','keep','apply-policy']`

PresentDevicePolicy setting
of usbguard-daemon.conf

Default value: `'apply-policy'`

##### <a name="-usbguard--daemon_restore_controller_device_state"></a>`daemon_restore_controller_device_state`

Data type: `Boolean`

RestoreControllerDeviceState setting of usbguard-daemon.conf

Default value: `false`

##### <a name="-usbguard--daemon_rule_file"></a>`daemon_rule_file`

Data type: `Stdlib::Absolutepath`

Path to the rules file. RuleFile setting
of usbguard-daemon.conf

Default value: `'/etc/usbguard/rules-managed-by-puppet.conf'`

##### <a name="-usbguard--rules"></a>`rules`

Data type: `Optional[Array[String[1]]]`

Array of strings with rules to pass to usbguard::rule

Default value: `undef`

### <a name="usbguard--config"></a>`usbguard::config`

usbguard::config

### <a name="usbguard--install"></a>`usbguard::install`

usbguard::install

#### Examples

##### 

```puppet
private class - don't use it directly
```

### <a name="usbguard--service"></a>`usbguard::service`

usbguard::service

#### Examples

##### 

```puppet
this is a private class - don't use directly
```

## Defined types

### <a name="usbguard--rule"></a>`usbguard::rule`

Manage a usbguard rule

The usbguard class needs to be included before calling this
defined type.

#### Parameters

The following parameters are available in the `usbguard::rule` defined type:

* [`rule`](#-usbguard--rule--rule)
* [`order`](#-usbguard--rule--order)

##### <a name="-usbguard--rule--rule"></a>`rule`

Data type: `String`

A line of rules.conf

Default value: `$title`

##### <a name="-usbguard--rule--order"></a>`order`

Data type: `String`

Order for the concat resource

Default value: `'500'`

